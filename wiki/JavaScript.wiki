#summary Scripting QBoard with JavaScript
#labels Docs-User

= Introduction =

Starting with version 20080827, QBoard is getting JavaScript support.

This document gives an overview of what's possible with the current code.

The things it can currently do:

  * Load new pieces by class name.
  * Set most basic properties (numbers, colors, and positions), though using a bit of an odd workaround (see the examples). By setting properties, pieces can be controlled.

Things that it cannot currently do:

  * Set piece properties using the natural JS properties syntax (it requires a function call instead).
  * Non-trivial properties cannot be properly _read_, only set. This includes colors (in some cases) and positions (QPoint objects).

Some of those are on the to-fix list, but i'm not currently sure how/if some of it can be properly done (that is, the way i want to see it work).

Some notable things which need improving include:

  * Send print() output somewhere sensible. It currently goes to stdout, which is only (marginally) useful if you launch QBoard from a console (i always do).


= Running JavaScript files =

To run a JS file in QBoard, simply double-click it. The JS print() command will send the output to stdout (your console, if you started QBoard from a console). Exceptions thrown from the script will be shown (with a stacktrace) in a dialog window.

= Examples =


Here are some example of things which currently work:

{{{
qboard.clear(); // clears the board of all items
qboard.board.loadPixmap( "maps/myMap.jpg" );
var pc = qboard.createObject('QGIHtml'); // create new piece
qboard.addItem( pc ); // add piece to the board
qboard.props( pc,{ // set a few properties:
  html:"<body bgcolor='#ffffff'>This is my text</body>",
  pos:QPoint(30,50)
});
}}}

Aside from creating objects and setting properties, there's not much it can currently do. That said, using properties one can control almost all aspects of a piece which can be customized via the popup menus.

Here is an overview of the list of common properties (in alphabetical order), their expected data types, and the piece types which support this property. The piece types are listed by their class name, and is the name which can be passed to `qboard.createObject("ClassName")` to create a new object.

|| *Property* || *JS data type* || *Piece types* || *Description* ||
|| `angle` || integer or floating point || QGIHtml, QGIPiece || rotation angle ||
|| `borderAlpha` || as for `colorAlpha` || QGIPiece || alpha level of a piece's border ||
|| `borderColor` || as for `color` || color of the piece's border || QGIPiece ||
|| `color` || string or QColor(r,g,b[,a]) || The color of the object. The string may be a common color name ("red" or "lightblue") or HTML notation ("#RRGGBB"). || QGIPiece, QGIDot ||
|| `colorAlpha` || integer or floating point || QGIPiece, QGIDot || alpha level of the piece's color. If the number is less than 1.0 is it considered to be a relative alpha level between 0.0 and 1.0, otherwise it is assumed to be an integer value between 1 (very nearly transparent) and 255 (fully opaque). ||
|| `html` || text || QGIHtml || HTML (a subset, actually) text to display. ||
|| `pixmap` || image filename, relative to QBoard Home || The picture used for an item. This determines the piece's size. || QGIPiece, the game board ||
|| `pos` || QPoint(X,Y) || x || the position of the piece, in x/y coordinates. ||
|| `scale` || positive floating-point number || QGIPiece, QGIHtml, QGIDot || Relative scale of the item, 1.0 being normal, 0.0 being non-existent, and 2.0 being double normal size. ||


  *   =  Piece types: 
  *  () = the picture used for a piece. This determines the piece's size. QGIPiece only.
  * () = . Piece types: all
  *  () =  Piece types: 